using Microsoft.Playwright;
using System.Web;
using InmateSearchWebApp.Models;
using TarrantInmateBotPlaywright;
using static System.Net.Mime.MediaTypeNames;
using ClosedXML.Excel;
using DocumentFormat.OpenXml.Wordprocessing;
using System.Text.RegularExpressions;

namespace InmateSearchWebApp.Services
{
    public class InmateSearchService
    {
        public async Task<string> RunAsync(string lastName, string username, string address, string firstname)
        {
            string phone = "5551234567";
            using var playwright = await Playwright.CreateAsync();
            var browser = await playwright.Chromium.LaunchAsync(new BrowserTypeLaunchOptions
            {
                Headless = false // uses new headless automatically
            });

            var page = await browser.NewPageAsync();
            await page.GotoAsync("https://inmatesearch.tarrantcounty.com/");

            // Fill last name
            await page.FillAsync("input[name=LastName], input#LastName, input[type=text]", lastName);
            
            await page.ClickAsync("button[type=submit], input[type=submit]");

            // Wait results
            await page.WaitForSelectorAsync("a[href*='Home/Details']");

            // Pick first inmate
            var first = await page.QuerySelectorAsync("a[href*='Home/Details']");
            var href = await first.GetAttributeAsync("href") ?? "";
            var qs = HttpUtility.ParseQueryString(new Uri("https://dummy" + href).Query);
            var cid = qs["CID"] ?? "";
            var name = (await first.InnerTextAsync()).Trim();

            await first.ClickAsync();
            Console.WriteLine($"Found inmate {name} (CID {cid})");

            // Vendor → AccessCorrections
            var vendorPage = await browser.NewPageAsync();
            var _acOptions1 = new AccessCorrectionsOptions
            {
                Username = username,
                Password = "StrongPassword123",
                FirstName = firstname,
                LastName = "Smith",
                Phone = phone,
                Address = address,
                MiddleName = "sumit",
                DateOfBirth = "02/12/1994",
                State = "Texas",
                City = "Dallas",
                Zip = "471642"
            };
            var acBot = new AccessCorrectionsBot(_acOptions1);

            await acBot.LoginOrSignupAsync(vendorPage);
            //await acBot.PreparePaymentAsync(vendorPage, "10445969", name);
            // await acBot.FindInmateByNameAsync(vendorPage, "DALLAS MACKENZIE JOHNSON");

            Console.WriteLine("✅ Flow finished up to payment preparation (no money sent).");
            return $"Found inmate {name} (CID {cid}). Flow completed successfully.";
        }
        public async Task<string> RunAsync2(string lastName1, string username, string address, string firstname)
        {
            using var playwright = await Playwright.CreateAsync();
            var browser = await playwright.Chromium.LaunchAsync(new BrowserTypeLaunchOptions
            {
                Headless = false
            });

            var page = await browser.NewPageAsync();
            await page.GotoAsync("https://inmatesearch.tarrantcounty.com/");

            var allInmates = new List<Inmate>();

            // Loop over A-Z for Last Name
            for (char c = 'A'; c <= 'Z'; c++)
            {
                Console.WriteLine($"Searching inmates with last name starting with {c}...");

                // Fill last name search box
                await page.FillAsync("input[name=LastName], input#LastName, input[type=text]", c.ToString());

                await page.WaitForSelectorAsync("select#recordsId");

                // Append a new option with value 2000
                await page.EvaluateAsync(@"() => {
    const select = document.querySelector('select#recordsId');
    if (!select.querySelector('option[value=""2""]')) {
        const option = document.createElement('option');
        option.value = '2';
        option.text = '2';
        select.appendChild(option);
    }
}");

                // Select the new option automatically
                await page.SelectOptionAsync("select#recordsId", "2");

                await page.ClickAsync("button[type=submit], input[type=submit]");
                //await page.FillAsync("input[name=LastName]", c.ToString());
                //await page.ClickAsync("button[type=submit], input[type=submit]");

                // Wait for results
                await page.WaitForSelectorAsync("a[href*='Home/Details']");

                var links = await page.QuerySelectorAllAsync("a[href*='Home/Details']");

                foreach (var link in links)
                {
                    var href = await link.GetAttributeAsync("href") ?? "";
                    var qs = HttpUtility.ParseQueryString(new Uri("https://dummy" + href).Query);
                    var cid = qs["CID"] ?? "";

                    //var fullName = (await link.InnerTextAsync()).Trim();
                    //var nameParts = fullName.Split(',');
                    //var lastName = nameParts.Length > 0 ? nameParts[0].Trim() : "";
                    //var firstName = nameParts.Length > 1 ? nameParts[1].Trim() : "";

                    //await link.ClickAsync();
                    //await page.WaitForLoadStateAsync(LoadState.NetworkIdle);

                    // Extract other details
                    //var dob = await page.InnerTextAsync("text=Date of Birth") ?? "";
                    //var gender = await page.InnerTextAsync("text=Gender") ?? "";
                    //var race = await page.InnerTextAsync("text=Race") ?? "";
                    string lastName = (await page.InnerTextAsync("text=Last Name")).Replace("Last Name:", "").Trim();
                    string firstName = (await page.InnerTextAsync("text=First Middle Name")).Replace("First Middle Name:", "").Trim();
                    string race = (await page.InnerTextAsync("text=Race")).Replace("Race:", "").Trim();
                    string sex = (await page.InnerTextAsync("text=Sex")).Replace("Sex:", "").Trim();
                    //string cid = (await page.InnerTextAsync("text=CID")).Replace("CID:", "").Trim();

                    allInmates.Add(new Inmate
                    {
                        CID = cid,
                        LastName = lastName,
                        FirstName = firstName,
                        //DOB = dob,
                        Gender = sex,
                        Race = race
                    });

                    //await page.GoBackAsync();
                }


                // Wait for results table
                //await page.WaitForSelectorAsync("table tbody tr");

                //var rows = await page.QuerySelectorAllAsync("table tbody tr");
                //foreach (var row in rows)
                //{
                //    var name = await row.QuerySelectorAsync("td:nth-child(1)");
                //    var gender = await row.QuerySelectorAsync("td:nth-child(2)");
                //    var firstName = await row.QuerySelectorAsync("td:nth-child(3)");
                //    var race = await row.QuerySelectorAsync("td:nth-child(4)");
                //    var bookingDate = await row.QuerySelectorAsync("td:nth-child(5)");
                //    var detailLink = await row.QuerySelectorAsync("a[href*='Home/Details']");

                //    allInmates.Add(new Inmate
                //    {
                //        LastName = await name.InnerTextAsync(),
                //        Gender = await gender.InnerTextAsync(),
                //        Race = await race.InnerTextAsync(),
                //        FirstName = await bookingDate.InnerTextAsync(),

                //    });

                //}
                // Clear search box for next letter
                //await page.FillAsync("input[name=LastName]", "");
            }

            // Sort by Last Name A-Z
            allInmates = allInmates.OrderBy(x => x.LastName).ThenBy(x => x.FirstName).ToList();


            //var cids = new List<string> { "0825225", "0571535", "1028118", "0884013", "1058465", "1062466", "0144412", "0895994", "1024278", "0599477", "0395930", "0573641", "0468452", "0641677", "0938581", "1062465", "1055231", "1012894", "0769926", "1026748", "1049590", "1055331", "1046496", "1060942", "1054088", "0382350", "0964671", "0421539", "0951989", "0781084", "0791664", "0642210", "0828329", "0778129", "1032305", "0965647", "0724619", "0890299", "0302266", "1051510", "0565923", "1046811", "0640743", "0431424", "1058300", "0594840", "1052477", "1058160", "1062704", "0890647", "1057118", "0821274", "0775533", "0476342", "1032267", "0643151", "0378521", "0647913", "0725217", "0987251", "0603324", "1062389", "0772374", "0890748", "0817452", "0830325", "1036824", "0998404", "0806688", "0896282", "0985200", "1033567", "0762744", "1034604", "0848975", "1011060", "1050900", "0741635", "1050130", "1000951", "0639155", "1008036", "0868412", "0531554", "0651739", "1012843", "0696418", "0890107", "1062564", "0770144", "0981120", "1043221", "1061754", "0585526", "1044036", "1063051", "0649774", "1062241", "1044973", "1050456", "0987733", "1061911", "0719898", "1058998", "0444251", "0461712", "1048959", "1059033", "1062455", "1016246", "0745292", "1032148", "0819608", "1051906", "0787753", "0298925", "1047714", "1060973", "0996479", "1062683", "0467879", "1058507", "1060842", "1044495", "1011981", "0503529", "1006306", "0960455", "0996919", "0781566", "1059652", "1029087", "0996028", "0589423", "0680302", "1045444", "0533934", "1026694", "1055683", "1040728", "0731258", "0949232", "0169570", "1056341", "1046481", "0485024", "0586262", "1062842", "0965214", "1037674", "1058340", "0695012", "0678024", "1009838", "0440900", "0377090", "1055624", "0987585", "1062228", "0534878", "0974164", "0764437", "0885238", "1058641", "0863512", "0998754", "1037769", "1037771", "0614550", "0646793", "0875188", "0941919", "0728701", "0980066", "1062325", "1042789", "0866231", "0859512", "0978399", "1059946", "0975313", "0859156", "1043396", "1060156", "0266318", "0427146", "0818410", "0736992", "0825225", "0571535", "1028118", "0884013", "1058465", "1062466", "0144412", "0895994", "1024278", "0599477", "0395930", "0573641", "0468452", "0641677", "0938581", "1062465", "1055231", "1012894", "0769926", "1026748", "1049590", "1055331", "1046496", "1060942", "1054088", "0382350", "0964671", "0421539", "0951989", "0781084", "0791664", "0642210", "0828329", "0778129", "1032305", "0965647", "0724619", "0890299", "0302266", "1051510", "0565923", "1046811", "0640743", "0431424", "1058300", "0594840", "1052477", "1058160", "1062704", "0890647", "1057118", "0821274", "0775533", "0476342", "1032267", "0643151", "0378521", "0647913", "0725217", "0987251", "0603324", "1062389", "0772374", "0890748", "0817452", "0830325", "1036824", "0998404", "0806688", "0896282", "0985200", "1033567", "0762744", "1034604", "0848975", "1011060", "1050900", "0741635", "1050130", "1000951", "0639155", "1008036", "0868412", "0531554", "0651739", "1012843", "0696418", "0890107", "1062564", "0770144", "0981120", "1043221", "1061754", "0585526", "1044036", "1063051", "0649774", "1062241", "1044973", "1050456", "0987733", "1061911", "0719898", "1058998", "0444251", "0461712", "1048959", "1059033", "1062455", "1016246", "0745292", "1032148", "0819608", "1051906", "0787753", "0298925", "1047714", "1060973", "0996479", "1062683", "0467879", "1058507", "1060842", "1044495", "1011981", "0503529", "1006306", "0960455", "0996919", "0781566", "1059652", "1029087", "0996028", "0589423", "0680302", "1045444", "0533934", "1026694", "1055683", "1040728", "0731258", "0949232", "0169570", "1056341", "1046481", "0485024", "0586262", "1062842", "0965214", "1037674", "1058340", "0695012", "0678024", "1009838", "0440900", "0377090", "1055624", "0987585", "1062228", "0534878", "0974164", "0764437", "0885238", "1058641", "0863512", "0998754", "1037769", "1037771", "0614550", "0646793", "0875188", "0941919", "0728701", "0980066", "1062325", "1042789", "0866231", "0859512", "0978399", "1059946", "0975313", "0859156", "1043396", "1060156", "0266318", "0427146", "0818410", "0736992", "0997701", "0474736", "0451750", "1052951", "0836395", "1062232", "0902715", "1027171", "0987359", "1057111", "0647862", "0744769", "0746530", "1045366", "1032807", "0659125", "1058744", "0963041", "1009537", "0658630", "0997933", "0558796", "1009368", "0959330", "1058760", "0996594", "1049771", "1025426", "1056988", "0627540", "1028250", "0542583", "0820242", "1041049", "1057984", "0991658", "1032509", "1052254", "0590022", "1057881", "1053019", "0991811", "1018639", "0811501", "0323203", "0198300", "1011212", "0810686", "0451146", "0151894", "0395426", "1044478", "1052560", "0721925", "0424145", "1041084", "0319691", "0687113", "1033252", "0595867", "0356817", "1051343", "0852960", "0683292", "0897430", "1051548", "0787104", "0811000", "1060706", "0638493", "0910789", "0875951", "0910765", "0941628", "0808037", "1015179", "0317503", "0701465", "1060981", "0723789", "0812592", "1057188", "0689111", "0834017", "0943643", "1055515", "1014232", "0220933", "0382980", "0770375", "1055329", "1048410", "0910016", "0567927", "0740731", "0864760", "0890672", "0966366", "0850978", "0478551", "0499981", "0883281", "0522674", "0485156", "0493286", "0956028", "0578990", "0733104", "0987090", "0879990", "0864233", "0941426", "1052557", "1043747", "1015474", "1021685", "0627092", "0870801", "0791582", "0944418", "0729369", "0644806", "1053415", "0600257", "1057703", "0881537", "0653536", "0011814", "0878062", "0511584", "0396817", "0954035", "0200354", "0839210", "0496124", "0926559", "0361815", "0949610", "1059111", "0851902", "0674827", "0490915", "0993374", "0885411", "0960266", "1062157", "1040876", "0920273", "0884164", "0889807", "0889274", "1016341", "0807587", "1062249", "0383313", "0054216", "0700415", "0217303", "0394051", "0818679", "0994334", "0767961", "1058893", "0920448", "0697096", "0192194", "0242571", "0915830", "0927344", "0758433", "1035085", "0776565", "1056807", "1019885", "1041819", "1017228", "0665312", "0517765", "1048570", "0760217", "1024578", "0304968", "0669242", "0738263", "1028776", "1024677", "1024858", "0916645", "0822227", "1056855", "0788315", "0902971", "0354314", "1062192", "0975118", "0971098", "0967844", "1051594", "0634971", "0734566", "0956825", "1059714", "0974272", "0717264", "1000374", "1046773", "0945746", "0971308", "0789953", "1014879", "0173365", "0742038", "0144686", "0783910", "0519059", "0794566", "0961652", "0687642", "1042344", "0887355", "0708174", "0980939", "0941841", "1005630", "0851764", "0689548", "0498461", "0663342", "0963670", "0339369", "1052630", "1060854", "1059877", "0895629", "1034691", "1056433", "1059976", "1041534", "0211933", "0869901", "0846276", "1051232", "0956249", "0635980", "0856551", "1033244", "1019627", "1059491", "1060796", "1041288", "1013901", "0537451", "0712558", "0719918", "0711446", "0656290", "0843313", "1047450", "1049352", "0797902", "0821868", "1049460", "0714261", "0877630", "0841442", "1057872", "1057222", "0563039", "0962487", "0967735", "0824914", "1001964", "1035199", "0691401", "0991147", "0433729", "0466580", "0546832", "1045509", "1058274", "1054158", "0671642", "1045421", "1062170", "0249408", "0797153", "1004429", "1031804", "1027590", "1018614", "0333813", "1035582", "0524482", "0471838", "0296147", "0259617", "0698235", "0551328", "0979649", "0700877", "1011539", "1030760", "1049978", "0982419", "1047661", "1039896", "0497659", "0202277", "0956846", "0884603", "0517172", "0713269", "0837148", "0887213", "0924127", "0764429", "0696360", "0361623", "0937957", "0988885", "0694272", "1037345", "1018286", "1057602", "0130672", "0419784", "0585247", "1011075", "0855890", "1063059", "0730433", "1053691", "1062949", "1058849", "0648956", "1026644", "0747845", "1004327", "1061408", "1022304", "1003177", "1020676", "1031890", "0785413", "1062488", "0643613", "0542505", "0726069", "1061382", "0708575", "0925724", "0923575", "0711032", "1058859", "0502300", "0693441", "0470248", "1019661", "1051865", "1045016", "1035992", "1061487", "0942208", "1020726", "0706713", "0766385", "0459087", "1047993", "0953876", "1025640", "1048239", "0958257", "0754359", "1011927", "0887038", "1027367", "1023306", "1058262", "1056600", "0710303", "1030576", "0592209", "1057114", "0722776", "0932819", "0694966", "0378606", "0750258", "0618336", "0420828", "0938172", "0906123", "1063055", "0818330", "1021903", "0576036", "0690513", "0865581", "0655908", "0709430", "0854817", "1039462", "1041142", "1007329", "0906939", "1041529", "1058273", "1025615", "1028617", "0943577", "0852660", "0967725", "0750391", "0936118", "1023531", "0711480", "1058025", "1058891", "0488180", "1050742", "0943783", "0584208", "0803369", "0968420", "0915998", "0709066", "0965172", "0426004", "0792100", "1062519", "0487944", "1026728", "0756109", "0149487", "0782535", "0837879", "1032698", "1034322", "1062635", "0755929", "0997236", "0321430", "1059161", "0298692", "0731465", "1011663", "0862062", "0900838", "0996604", "0882548", "0811956", "0748993", "1057851", "1034782", "1057903", "0205178", "0977996", "0972832", "0911025", "1015782", "0725688", "0995321", "0788495", "0507952", "0897120", "1029520", "0801095", "1056618", "0834030", "0915708", "1052278", "1020718", "1031481", "0148360", "1033868", "0988497", "0982353", "0885837", "0696429", "0626660", "0832502", "1058254", "1060447", "0596916", "0215079", "0488093", "0972995", "1063075", "0658008", "1053246", "0360130", "0897830", "0687374", "0822201", "0774098", "1058014", "1048233", "1056489", "0839794", "1045663", "0991322", "1002143", "0650960", "0833721", "0792786", "0926472", "0975767", "0948860", "0958348", "0303258", "0987948", "0851977", "0585195", "0375755", "0868911", "0479696", "0964493", "0849970", "0631245", "0805421", "0299796", "0605489", "0649129", "0427329", "0790938", "0347490", "1062941", "0812163", "0829097", "0698697", "1037906", "1061594", "1046636", "1026385", "0829012", "0613886", "1058219", "0949738", "1062712", "0732152", "0995224", "1058805", "0493220", "0715422", "0954755", "0992613", "1036131", "0580850", "0458536", "1012158", "0973089", "0859513", "1057981", "0944107", "0836742", "0921792", "0943771", "1049348", "1052858", "0937608", "0687778", "1035787", "0818527", "0640055", "0312444", "0827736", "0663204", "0757918", "0640994", "1051153", "1013563", "0653543", "0581409", "0955596", "0984488", "0490125", "0965956", "0142432", "0660696", "0562452", "0357317", "0486375", "1023205", "1062532", "0590304", "0728670", "1054882", "1033698", "1036357", "0560932", "1062005", "1056005", "0572651", "0600719", "0985782", "0816954", "0924804", "1051965", "0186625", "0932703", "1062880", "0615024", "1011312", "1059340", "1053218", "0451105", "1062469", "0951109", "0434247", "0976771", "1060938", "1044941", "1002357", "0987079", "0979766", "0433308", "1008269", "0542725", "1026606", "0409738", "1020776", "0838955", "0603786", "0947659", "1055523", "1050498", "0985201", "1061151", "1059145", "0703982", "0838145", "1044039", "1057134", "1051299", "0897189", "0729044", "0806677", "1051729", "0936101", "0571090", "0860659", "0690553", "1059420", "1002933", "0245133", "0985952", "0811118", "1017855", "0250047", "0692127", "0671741", "0491325", "0516835", "1063079", "1021791", "0834146", "1002863", "0744854", "0528960", "0860235", "0237659", "0752333", "1051664", "0729273", "0457573", "0622814", "0483158", "0956271", "0517964", "0512673", "0546712", "1000115", "0726942", "0267279", "1059034", "0729820", "0966494", "0139212", "0792233", "0437563", "1043636", "0785905", "0997277", "1058597", "1052707", "0729340", "0717186", "1046806", "0934394", "0432842", "0936470", "0759024", "0849276", "1048167", "1028698", "0564708", "0912788", "1028679", "0676413", "0279537", "0959332", "1053223", "0857609", "0259187", "1054770", "0917052", "1018050", "1057256", "0938864", "0149776", "0224724", "1043643", "0560364", "0907376", "0893111", "1043390", "0817861", "1063032", "0671762", "0720548", "1040338", "0717332", "0847212", "0757461", "0749867", "1020466", "0943988", "0305146", "0691115", "0280368", "1018039", "0988360", "0757021", "0155214", "0858531", "0935371", "0674300", "0761494", "0988403", "0625932", "0588370", "1062689", "0812380", "0952369", "1047157", "0591169", "0056214", "1050147", "0448607", "0910135", "0860856", "0776284", "0962184", "1062116", "1062369", "0982340", "1050903", "0034285", "0726889", "0377143", "0935441", "0853367", "0891001", "0200741", "0930676", "0663811", "0918485", "0461585", "0225077", "0911454", "0715399", "1000309", "0682123", "0766546", "1020695", "0766349", "0833760", "0939937", "1055342", "0998964", "1047898", "0829493", "1023073", "0781407", "0933301", "0970082", "0962412", "0926809", "1019531", "0901515", "0776615", "0929977", "0545206", "1035342", "1032325", "1010715", "0944820", "1026445", "0932746", "0675852", "0806794", "0896438", "0429613", "0621957", "0915323", "0868525", "0463465", "0903704", "1021031", "0935919", "0960833", "0767529", "0014043", "0865637", "1028465", "0884003", "1044107", "0724194", "1003599", "0744193", "1054610", "1055348", "0535300", "0510131", "0704146", "1061275", "1049020", "0967947", "1062904", "1057096", "1006877", "0547090", "1012996", "0426503", "0107039", "0464174", "1062831", "1060397", "0992526", "1020421", "0820765", "1049824", "0348689", "0904660", "0476195", "0380907", "0779390", "0388024", "0673569", "0890292", "0831986", "0793351", "0543848", "1059458", "0840759", "1044181", "1024435", "1017376", "0749242", "0804016", "0897873", "0747119", "0955721", "0657351", "0751880", "1023860", "0689186", "0444245", "0950640", "0401366", "0916003", "1031079", "1062667", "1058416", "1062710", "1019831", "0177947", "1051515", "1061436", "0694467", "1055002", "1044789", "1062238", "0783710", "1038369", "0960142", "0682895", "0880042", "1053773", "1010757", "0748796", "0894637", "0253507", "0542884", "0549220", "0554355", "0847741", "1021915", "1055420", "0944624", "1017154", "1047766", "0675254", "0867125", "1029407", "1002687", "0880662", "0154407", "1054578", "0946816", "1059375", "0818592", "1046333", "1061559", "1062587", "0937570", "0794138", "0643758", "0857304", "0991375", "1020023", "1060209", "0854702", "0718742", "1055802", "1061546", "1002731", "0306450", "0718657", "1048539", "1017178", "0820766", "0678617", "0987333", "0881156", "1045483", "0887947", "0886810", "0523037", "0948829", "0569212", "1038363", "0897284", "0588576", "0251750", "1055036", "1056246", "0988810", "1048473", "0732920", "0875853", "0931459", "1043968", "0992305", "0535488", "0787092", "0779879", "0673747", "0823969", "0228855", "0022719", "1053899", "0715210", "1060823", "0722512", "0934984", "0968591", "0888445", "0541769", "0892738", "0734602", "1013821", "0573918", "1048871", "1061404", "0728409", "0840050", "0597633", "0966236", "0993796", "1027829", "0925684", "0502933", "0694552", "0942632", "0994191", "1062938", "1027257", "1053692", "1022559", "0793334", "1013862", "1049156", "0826241", "0582645", "0543535", "0976593", "1005684", "0919251", "1062806", "0986949", "0782124", "0817017", "1047303", "0899936", "1047292", "0893601", "0887235", "1060071", "0939262", "0669511", "0531348", "0554420", "0935276", "1049363", "0699289", "0266214", "1060565", "0276044", "0744712", "0677251", "0164825", "1019150", "1028823", "0984085", "0823961", "0969800", "0945543", "1004480", "1033853", "1040942", "0857013", "1026208", "0651677", "0993446", "0363669", "0463769", "0691751", "1051974", "0578425", "0851227", "0360522", "1054681", "0369275", "0806496", "0717910", "1062873", "1062860", "0851110", "0531794", "1054456", "0588246", "0446110", "0475137", "0797353", "0740530", "1050410", "1061923", "1049777", "1031690", "0965731", "0668574", "1004187", "1062014", "0954235", "0845303", "0946421", "1058400", "0275409", "0695451", "0891928", "0872128", "0854876", "0680839", "0759883", "0723068", "1057400", "1018041", "0309277", "1036656", "0534581", "0957273", "0670063", "0646795", "0894237", "0753528", "1040557", "0987091", "0871450", "0559875", "0981211", "0865258", "1060814", "0493398", "0774916", "1045896", "0658868", "1060721", "1063029", "0261132", "0891560", "0561399", "0955591", "0912609", "0226114", "0580208", "0830999", "1053049", "0691172", "1028629", "1018188", "1043976", "1045264", "0717927", "0879928", "0945533", "0629253", "1062877", "0310903", "0944591", "1051183", "0934431", "0988812", "0337331", "0941682", "0898061", "1056948", "0542678", "0945628", "1017429", "0624716", "0977427", "0741086", "0966888", "1057443", "0781162", "1005126", "0932659", "0899001", "1009137", "0727353", "1009332", "0789674", "0685489", "1027461", "0383590", "1059137", "0598332", "1052535", "1062709", "0517391", "0849186", "0775859", "1031649", "1054159", "0654913", "1023808", "0944447", "1046501", "1032844", "0641262", "0975473", "0719478", "1062595", "0814887", "1006976", "1059893", "1062987", "1002333", "0571995", "0855388", "1054095", "0674451", "1059708", "1054467", "0914703", "0959208", "1032562", "0728862", "0970735", "0803388", "0944059", "1058301", "1054458", "1028214", "0821737", "0743392", "0490909", "0672711", "1054874", "0589828", "0184842", "0411022", "1062426", "0597931", "1020681", "0814848", "0688044", "1043708", "0957239", "1055177", "0919333", "1057201", "0659278", "1022750", "0877664", "1015079", "0758768", "1062537", "0994833", "1062839", "0995755", "1023267", "0415102", "1059769", "0788696", "0969172", "0919198", "0958846", "0759936", "0844008", "0542119", "1060560", "0980162", "0226707", "1048911", "0980085", "1054794", "0707324", "0975765", "0593684", "0806455", "1052589", "1062833", "1062393", "0963756", "0928454", "0750062", "0426084", "1062053", "0256731", "1036098", "0484260", "0646622", "0644610", "0988365", "0893164", "0491619", "0416206", "0486074", "0391693", "0634265", "1047954", "1008892", "0591487", "1024413", "1056979", "0874776", "0963865", "1052200", "1056995", "1030336", "1045160", "0577836", "1042217", "1002308", "0650698", "0325199", "0268293", "0699830", "0873865", "0966604", "0974491", "0442406", "1030724", "0961192", "0560589", "1063069", "0783851", "0906247", "1029905", "1056130", "0803059", "0574064", "1051654", "1052216", "0999758", "0912429", "1059468", "0830358", "0925025", "0984920", "0985255", "1061815", "0684259", "0917044", "1008323", "1025245", "0713817", "1031732", "1039829", "1019952", "1037576", "0727029", "1010489", "1042372", "0796488", "0915395", "0999155", "1047600", "1050835", "1009486", "1060113", "1061018", "0998292", "0723257", "1062552", "0738801", "0794353", "0836706", "1027241", "1045652", "1062495", "1009711", "1004941", "0842700", "1046138", "0791017", "0802263", "1049012", "0604451", "1041549", "0856763", "1060190", "0324500", "1046511", "1055077", "0697645", "0810934", "0873739", "0284535", "1051650", "0751863", "0945008", "0932374", "0728411", "0694867", "1026751", "0611403", "0874620", "0131465", "1052584", "0375552", "0833455", "0569617", "0961119", "0753991", "1050221", "1062147", "0830994", "0907722", "0952770", "1055445", "0445923", "0856461", "0631876", "0593517", "0621241", "1052582", "0306792", "0836679", "1024151", "0573355", "0880884", "0752851", "0208640", "0242220", "0812565", "0537821", "0954884", "1007058", "0560856", "0715632", "0290564", "1051337", "1021010", "0787177", "0965393", "0966763", "0721909", "0724885", "1050043", "0954071", "0939881", "0722659", "1053009", "0830760", "0567868", "0564505", "0895473", "1017101", "0907960", "0878949", "0680761", "0638107", "0449696", "1042513", "1033591", "1053978", "0630437", "1003987", "0788300", "0936683", "0971166", "1062861", "1013386", "0531605", "1059148", "0326430", "0644045", "0855734", "1062901", "1032880", "1058039", "1061234", "0885166", "0704873", "0697029", "1060461", "0321141", "0872689", "0662744", "0580025", "0316798", "1041526", "0654485", "0680208", "0723651", "0763538", "1055462", "1063028", "0963221", "0730874", "1033236", "0351232", "0192677", "0921261", "0376064", "0991183", "0226141", "0723203", "0812568", "0904426", "0716059", "1039647", "0918419", "0635159", "0593921", "0739843", "0799447", "0879925", "0798192", "0961372", "0914224", "1052268", "0149479", "1059603", "1003352", "0805494", "1058140", "0983354", "0968554", "0671037", "0926679", "0796875", "0862541", "0667623", "0873183", "1057644", "0875513", "0933543", "1055007", "1050499", "1057965", "0356004", "0342473", "1057255", "0614137", "0166710", "1032780", "1061101", "0771472", "0204263", "0317221", "1023492", "0524638", "1029012", "0801125", "0751693", "0774483", "0799242", "0291312", "0592184", "0989317", "0674870", "0720077", "1017194", "0845598", "0956180", "0650074", "0805205", "0568771", "1054692", "0868403", "1062838", "0971099", "0988009", "1055760", "0498405", "0862749", "0903792", "0783786", "0732487", "1045816", "1013921", "1002985", "0446698", "1013571", "0813409", "1060204", "0923151", "0635840", "0633242", "1053116", "0177464", "0619108", "1052356", "0441910", "0317601", "1046108", "0923545", "0512656", "0852179", "0575815", "0810630", "1062939", "0525533", "1050037", "0620657", "0893121", "1053095", "0951610", "0753388", "1057342", "1003179", "0239096", "0929320", "0746575", "1043447", "0685299", "0912911", "0978744", "0741256", "1012488", "1025286", "1009276", "1062036", "1061391", "1061560", "0408477", "0321885", "0595207", "0943386", "1008282", "0911638", "1056289", "1027203", "0488540", "1038032", "0658672", "0403390", "0556101", "0677430", "1059809", "0970488", "0859159", "0274146", "1043435", "0743428", "1023132", "1043761", "0597175", "0931137", "0823292", "0837201", "0721966", "1038503", "0786068", "1049429", "0926109", "0787065", "0581058", "0972946", "1060182", "0952774", "0748000", "0922443", "0926926", "0832766", "0758711", "0779057", "0972295", "0876355", "0976106", "1058296", "0571473", "0994472", "0799884", "0879883", "0924627", "0830104", "0313940", "1052178", "0819980", "1015233", "0338942", "0147344", "0776738", "0710371", "0303472", "1061005", "0948759", "0357598", "1048284", "1029093", "1062267", "0848268", "1056519", "1047856", "1056070", "0845584", "0706242", "1044387", "0758037", "0900990", "0393476", "1059469", "0470903", "0934875", "0743709", "1034758", "0876247", "1063044", "0755337", "0604194", "0721752", "1034207", "0901547", "1047339", "0847438", "1004198", "0989602", "0709022", "0619343", "0853328", "0935023", "0034357", "0826083", "0989998", "0980996", "0605051", "0008983", "1058352", "1037921", "0938391", "0966840", "0594850", "0191701", "0921928", "0979297", "1054278", "0329717", "0712381", "1053762", "1054437", "0307295", "0223112", "0571568", "0993808", "1044793", "0346792", "1036568", "1036806", "0930431", "0914687", "1055630", "0627826", "0946242", "0799431", "0377899", "0822506", "0978352", "0595943", "1048467", "1061045", "1057157", "0036573", "0985153", "1051128", "0678066", "1060549", "1003264", "0884243", "0831002", "0909663", "1055650", "0389313", "0998437", "1060351", "1030615", "1047842", "0753204", "0842181", "0958559", "1010334", "1062661", "0674273", "0654119", "1034030", "0385940", "0849818", "0607810", "0890017", "0177601", "0880610", "1040548", "1034434", "0960362", "0925562", "1047682", "1023587", "0656209", "0710114", "0537542", "1048251", "1058019", "0950437", "0602939", "0623681", "0724238", "0711079", "0828706", "1053089", "0967005", "0798522", "1009292", "1052965", "0995171", "1060382", "0641268", "1040193", "0981903", "0731289", "0362159", "0896725", "1057496", "0174934", "0927796", "1038046", "0882285", "0931997", "0922961", "0988084", "0674604", "0656007", "0837926", "0993354", "1012812", "0388195", "0579476", "0442725", "0811617", "0332869", "1034852", "0795144", "1039938", "0847468", "0997192", "0696067", "1036305", "0896800", "1060245", "0887630", "1053760", "1057052", "0600747", "1033167", "1060169", "0867168", "0626341", "0915962", "1060163", "1059456", "1033658", "0498754", "0843144", "0661810", "0966412", "0823488", "0235907", "1041124", "0520348", "0898287", "0735286", "0478051", "0589999", "0598700", "0723345", "0535555", "1012664", "1056985", "0982955", "0786753", "1059489", "0956547", "0940238", "0951813", "1051046", "0945575", "1061428", "0204634", "0879104", "0998100", "0798704", "1037582", "0626263", "1045586", "1059124", "1052682", "1043992", "0531552", "0983522", "1044170", "0492099", "0884129", "0336660", "0083325", "1051039", "0425060", "1025510", "1056760", "0577872", "1039484", "0477895", "1023807", "0521181", "0882248", "1024940", "0707525", "1022816", "1028170", "1032335", "0913343", "1015800", "0935972", "0822486", "0477779", "0994905", "0929089", "1029069", "0282950", "0995049", "0180207", "1055651", "0927527", "0891162", "0282125", "1052305", "0292462", "0660948", "1053016", "0804809", "0967426", "0870462", "0733101", "0949536", "0856758", "0845348", "1046958", "0669514", "1056620", "0972505", "0475436", "0363840", "0940200", "1056224", "0973461", "1045969", "0653273", "0342906", "0874161", "0980663", "0671903", "0902945", "0663242", "0536382", "0765703", "0822892", "1060724", "0852374", "0680590", "0865709", "1015010", "0659810", "1044093", "0233179", "0294868", "0849847", "0707792", "0980108", "0452006", "0151659", "1045412", "0842672", "0875722", "0700560", "0451395", "0849683", "0914439", "0364913", "0699997", "0626889", "1052094", "1062870", "0995769", "0863738", "1028546", "0538596", "0907239", "1063007", "0964516", "1040918", "0173382", "1059649", "1060876", "1004483", "1058472", "1036427", "1048549", "0535701", "1051571", "1038655", "0844734", "0982005", "1036045", "1063068", "0654198", "0627014", "0614790", "0990577", "0555538", "0781257", "0976329", "1018193", "0998001", "0895989", "0996653", "1037957", "0917214", "1009030", "1053821", "0715420", "0508541", "0902524", "0937106", "0933557", "0873725", "0760584", "0989707", "0509933", "1030910", "0861957", "1036208", "0919151", "0687600", "1003423", "0512527", "0839998", "0532987", "1042363", "0055451", "1014727", "0934876", "0739487", "0806772", "1062924", "0330929", "1059763", "0899557", "1047000", "0521518", "1015508", "1014103", "1061022", "0714714", "1006629", "0783130", "1032623", "0657840", "0730972", "0803613", "0235164", "0864972", "0754965", "1052687", "0863294", "0387107", "1009043", "0569564", "0988445", "1062665", "1024080", "0833545", "0927873", "1059404", "0799168", "0967302", "1060844", "0866334", "0750355", "1052567", "0910696", "0860511", "1021250", "1054045", "0570260", "0918894", "1014377", "1062788", "0685925", "0767998", "0942433", "1031185", "0995948", "0888184", "0232923", "0354464", "0127644", "0684632", "0831042", "0995304", "0954060", "0575076", "0425626", "1061484", "1062977", "0851463", "1044709", "0891967", "0731563", "1001051", "0729774", "1048177", "0972653", "0973304", "0296181", "0676134", "0764483", "1058234", "0532939", "0819957", "0714153", "0756224", "0776417", "0734524", "0278732", "0172948", "1000184", "0439046", "0982391", "1050700", "1062219", "1057085", "1054197", "0557541", "1060460", "1045546", "1054078", "0848703", "0746001", "0360441", "0578613", "1061158", "1062993", "1041096", "1046345", "0761139", "1022737", "0523741", "0687854", "0982287", "1013428", "0544763", "0921662", "0409534", "0959239", "1022650", "1047792", "0713217", "0821253", "1031057", "0221600", "0331972", "0239178", "1044220", "0717839", "1001967", "0911263", "0986609", "0431511", "1061078", "0847328", "0586532", "0857006", "0833475", "0940512", "1045690", "1040270", "1038475", "0669474", "1048405", "0859419", "0688774", "0861793", "0838147", "0820819", "0894307", "0965791", "0912017", "1040290", "0346572", "0810226", "1030916", "1049578", "1054899", "0967214", "1028496", "1032380", "0986936", "0975361", "1061801", "0419627", "1034790", "0567304", "0991338", "0278101", "1015468", "0489189", "1041977", "0510208", "0791706", "1037707", "1026332", "0786749", "1041986", "0946631", "1057580", "0244503", "0541125", "0634353", "0998760", "0642753", "0695475", "1061308", "1062607", "0446344", "1032761", "1047186", "0628831", "0808016", "0658619", "0969004", "1030229", "0631605", "0809709", "0961249", "1057534", "0979669", "0528720", "0859371", "0998861", "1021715", "0524342", "0870889", "0884171", "0944300", "0961257", "1062471", "1046922", "1063048", "1003046", "0732550", "0958998", "1061652", "1055345", "0703220", "0879548", "0931884", "0748629", "0609930", "0818361", "1054800", "1026992", "1051072", "1058542", "0984135", "1052400", "1031434", "0824731", "0761688", "1030109", "1054972", "0847493", "1055923", "1053570", "0943873", "0827441", "0511632", "1062059", "0589208", "0674461", "1048704", "1016656", "0955476", "0810764", "0598442", "0861464", "0779748", "1014044", "0903373", "1062470", "0981734", "1021474", "0944408", "0784827", "0660572", "1040072", "0985801", "0749672", "0619963", "0872631", "0924553", "1063066", "0695920", "0908866", "1061805", "0860121", "0790119", "0949007", "0408467", "1062254", "0770262", "0843747", "0853076", "0536489", "0873729", "1017169", "0991774", "0677623", "0938290", "0604618", "0569300", "1059023", "0841130", "0688672", "1023940", "0947240", "1048969", "1053069", "0750630", "0979130", "0994879", "0805861", "1060188", "1049481", "1044446", "0503252", "0490332", "0467005", "1019678", "1010316", "0953366", "0873022", "0433918", "0800577", "0412165", "0914536", "0913711", "0942898", "0795999", "1010690", "0878070", "0995001", "0992816", "1062956", "0660179", "1058328", "1033712", "0991517", "0765241", "0557278", "0767985", "1055461", "1048514", "1063005", "1055337", "0618793", "0737777", "1024011", "1033898", "0816842", "1063057", "0787444", "1060027", "0328655", "0862128", "0986233", "1031179", "0938043", "0829274", "0777712", "1051512", "0940306", "1026862", "0773258", "0655029", "0527827", "0847962", "1034587", "0966303", "0981100", "1053314", "0659137", "0773566", "0433042", "0805686", "0825102", "1062500", "1062015", "1044401", "0930998", "0891814", "0656339", "0943656", "0663312", "0884853", "1041138", "0669371", "1016088", "0703409", "1058674", "1013017", "1018608", "1062429", "1031880", "0421236", "1005693", "1048274", "0649562", "0878849", "1038790", "1060232", "0373961", "1060538", "1022915", "1014169", "1009323", "1053002", "1060685", "0161737", "1039832", "1023046", "0812243", "0916063", "1000665", "1055412", "1062102", "0625032", "0238221", "0568564", "1023751", "0787518", "0789428", "1047812", "0482296", "0434412", "0475703", "1058099", "0797783", "0168707", "0281729", "1059276", "1052880", "1016695", "1055207", "0318819", "0265345", "0712070", "0929313", "1062999", "1062723", "1062640", "0693929", "0709034", "0979843", "1062453", "1041162", "0966654", "1033648", "1062565", "1063067", "1011962", "1063058", "1020911", "0978280", "0533802", "1055281", "0644563", "0371681", "1000904", "0662826", "0947053", "0908551", "1058020", "0746632", "1016871", "1057168", "0835813", "0713688", "0996763", "0948505", "0918440", "0942858", "1023470", "1054553", "1040975", "1039754", "0989348", "0927655", "0815923", "0406385", "1047881", "0626842", "0728634", "1061072", "0789465", "0744445", "0425922", "0379575", "0314464", "1058706", "1018265", "0691727", "1045396", "1046194", "1060662", "0297730", "0988864", "0459860", "0730840", "0808450", "1038229", "1049033", "1029052", "1035409", "1061317", "0546783", "1048546", "0984111", "1047111", "0544462", "1052632", "0300838", "1062016", "1057005", "0987400", "1043993", "0749501", "1050724", "0929890", "0833032", "0844068", "0992277", "1061621", "0909763", "0917201", "0666437", "1059391", "1054227", "0605395", "0941549", "0495136", "0796770", "0949005", "0845004", "1035949", "1057914", "0913465", "0789641", "1053944", "0504604", "1043365", "0981371", "1056555", "0412583", "0572675", "0325259", "0435283", "0725742", "0990925", "0906000", "0819320", "1034558", "0964001", "1043981", "1011852", "0726789", "0671993", "1053975", "0446580", "0683082", "0774463", "1024629", "0883690", "0850335", "0930893", "0711198", "0567099", "0342334", "0747587", "1055710", "0932933", "0665750", "0838584", "0144159", "1055447", "0911173", "0174745", "1060519", "0841768", "0978398", "0949210", "0767188", "0938806", "0917386", "0871346", "0311706", "0514022", "0947287", "0953802", "0309231", "0817155", "1052581", "1061747", "0539188", "0982968", "1040615", "0737990", "0315688", "0830102", "0903198", "1036091", "0759053", "1060733", "0452568", "1043920", "0957928", "1042052", "0950456", "0487294", "0254751", "0912900", "0935650", "0945682", "0267574", "0687759", "0948820", "0954672", "1063046", "0631054", "0913918", "0905508", "0934475", "0992109", "0992393", "0467529", "0988709", "1015700", "1029105", "1027566", "1037012", "0899925", "1062626", "1063023", "0874736", "0904903", "0058802", "0277652", "1062022", "1057170", "1062714", "0800017", "0559763", "0984498", "1014960", "1042006", "0009524", "1039296", "0496535", "1033070", "1043805", "0289732", "0908390", "0871366", "1062945", "1062310", "0726606", "1056954", "1062930", "1036482", "0935103", "0815230", "0980549", "1029013", "1042979", "0764219", "1023650", "1029668", "0922920", "1006985", "0678258", "0594142", "1048619", "0669908", "0844405", "0890493", "0384347", "1041564", "1053726", "1025471", "0701378", "0511070", "0947931", "0428983", "0642878", "0576227", "1061690", "0837928", "0772034", "0373522", "1000064", "1063053", "1060521", "0287064", "1045234", "1006912", "0874308", "1035263", "1034544", "1008154", "0875549", "0982745", "1017340", "0342582", "0723328", "0803143", "1000055", "0909792", "1034567", "0971994", "1025204", "1045834", "0596217", "0229773", "0784983", "0232161", "0298126", "1062129", "0917550", "0522254", "0161825", "0860587", "1008894", "0861446", "1049351", "1008778", "1043206", "0941279", "0857788", "1039242", "0980824", "0576810", "0956372", "1046209", "1060150", "0685403", "0986144", "0995734", "0699525", "1062567", "0996542", "0798479", "0970259", "0749240", "1022582", "0874109", "0478996", "0566157", "1007438", "1005391", "0735813", "1054107", "0999147", "0890900", "0979967", "1025057", "1006970", "1042178", "0745233", "0779819", "1056164", "0996986", "0446601", "0717787", "0563734", "0656607", "0179032", "0752595", "0986136", "0868479", "1053983", "1061803", "0913806", "0999906", "0930929", "0987570", "0963069", "1032000", "0649161", "1056870", "1056606", "0323634", "1062662", "1051424", "0825840", "1062791", "0807689", "0985177", "1054343", "1051444", "0807635", "0758598", "0828478", "1045660", "0900435", "0788271", "0863862", "0278651", "0204377", "1061617", "0845828", "0712881", "0689212", "0652231", "1047137", "0766161", "0700045", "1011671", "0237745", "1063008", "0983186", "0920258", "0845319", "0782830", "1063064", "0846742", "0568874", "0692035", "1034524", "0417740", "1062606", "1005768", "0677959", "0828361", "1025953", "0768404", "0769648", "1050072", "0866204", "0475262", "0991409", "0701699", "0895870", "0788807", "1051623", "0788506", "0965295", "1051772", "0335625", "0566255", "1045242", "0927923", "0253547", "0371368", "0513713", "0659962", "0954964", "0935122", "0784204", "0705804", "0357285", "0163516", "0670848", "0576181", "0714648", "1001004", "0821557", "0947434", "0720311", "0562069", "0407991", "0873733", "1009522", "0828344", "0620437", "0517432", "0837276", "0767887", "0561717", "1061446", "0998794", "1053987", "1059214", "0862123", "1015743", "0570482", "0496329", "0851105", "0490700", "0535990", "0586503", "0884694", "0859537", "0804298", "0767061", "0835133", "0974014", "1053742", "1057855", "0984268", "0169880", "0529279", "0040854", "0418909", "0457691", "0718432", "0926408", "0715342", "0794383", "1015014", "1060119", "0773461", "1031930", "1014987", "0855413", "0165738", "0673274", "1028609", "1061732", "0759185", "0843189", "1031805", "0799231", "1017904", "0851811", "1052367", "0544264", "0556787", "0645134", "0639000", "1062756", "1002923", "0480472", "0888646", "0695500", "1033616", "0772383", "1036413", "1043128", "1000231", "0996578", "1000836", "1059204", "0333507", "0729126", "0894366", "1035417", "0528829", "1046901", "1062730", "0056923", "1059450", "1061142", "0953979", "0899644", "0683637", "1061089", "0718472", "0751266", "1051565", "1027435", "0790358", "0742916", "1001943", "0819358", "1022055", "0974643", "0182404", "0976766", "1061506", "0392643", "1050584", "0956082", "0909989", "1046649", "0695365", "0873251", "0786787", "0490299", "0321611", "1056539", "0791705", "0913331", "0754783", "0274150", "0966400", "0327979", "0977051", "1011610", "0322040", "0392400", "0530982", "0998582", "1059842", "1043039", "0914075", "0579271", "0531326", "0417952", "0706630", "0554027", "0933887", "0962014", "0974181", "0917859", "0636168", "0817734", "0811819", "0624875", "0466725", "1011828", "0982320", "0951604", "1056238", "0835680", "1027093", "0506385", "1036783", "0948353", "0958050", "1051043", "0896437", "1020914", "1032819", "1043975", "0897913", "0771734", "1004015", "0761253", "0944257", "1042939", "1034460", "1052248", "0292076", "0688619", "0465173", "0792865", "0866339", "1019882", "1057294", "1062550", "0589174", "1057774", "0835411", "1052969", "0202478", "0890982", "1060596", "1062940", "0962741", "0476377", "0582865", "1013086", "1059324", "0897907", "1027269", "0551336", "1041581", "1060322", "1020228", "0476377", "0582865", "1013086", "1059324", "0897907", "1027269", "0551336", "1041581", "1060322", "1020228", "0791834", "0892034", "1061612", "0282670", "0846312", "1040007", "0460459", "1062570", "0388618", "0513844", "0741629", "1062300", "0853370", "0619684", "0851705", "1062033", "1022364", "0712575", "0565969", "0489336", "0559082", "0424674", "0824000", "1001099", "1025807", "0826423", "1034869", "0980912", "0728807", "1062372", "1035544", "0771374", "0745207", "1036432", "0917176", "0390133", "0931587", "0918591", "1033941", "1009666", "0408468", "0753857", "0969030", "0869157", "0971292", "0855514", "0830603", "0788419", "1021958", "0967646", "0333274", "0578028", "0874232", "0745088", "0825990", "1063024", "0406175", "0856329", "1023175", "0994454", "0920170", "0649100", "1062485", "0843257", "0796818", "0850288", "0813249", "0530173", "0688191", "0744932", "1041601", "0742007", "0792112", "0986130", "1008562", "0694604", "0797885", "0961351", "0725244", "1009733", "1045522", "1060949", "0989412", "0929677", "0964633", "1009561", "1054149", "0604602", "1061030", "0702377", "0988955", "0797306", "0793262", "0518586", "0859275", "0384902", "0467067", "0484622", "1055564", "0938981", "0660040", "1056676", "1028493", "0877615", "0975306", "0803069", "1045602", "0987417", "0812330", "0976470", "1038604", "1030325", "0886342", "0768477", "0989750", "0648476", "0784190", "1062042", "0968990", "0367998", "0732033", "0941876", "0857403", "0539459", "0521820", "0979240", "0824689", "1051252", "1025699", "0754049", "1024070", "0826364", "0882252", "1004021", "0527850", "0934451", "0505709", "0757471", "0981359", "0779407", "0911369", "0967288", "1062874", "0445251", "0738012", "0960885", "1061372", "1058710", "1059157", "0977665", "0510875", "1061824", "1059355", "1053910", "0845386", "0834967", "1059139", "1049151", "0887946", "0945087", "0638373", "0955586", "0705198", "1051744", "1019050", "0955567", "0990097", "1037966", "1055265", "1048386", "0827723", "0994002", "1045650", "0897880", "1047795", "1008477", "0922402", "0771978", "1053054", "0581956", "0471936", "0884415", "1023346", "0149378", "0443958", "0392510", "1037108", "0961805", "0373849", "0339423", "1051669", "0820994", "0745720", "1050959", "0212155", "0680672", "0348451", "0720592", "0495803", "1051711", "1063006", "1055069", "0743719", "1058211", "1061540", "1044376", "0808268", "0898205", "0645336", "0731945", "0761275", "0800219", "1055599", "0663215", "1062484", "0967079", "0718515", "0997598", "1051842", "0815916", "1019877", "1061977", "0728128", "0805758", "1061066", "0978086", "1051557", "0978454", "1007986", "0838292", "0535635", "0949566", "0267575", "0211826", "1059406", "1034872", "0808360", "0945916", "1042573", "0799741", "0928197", "0824275", "0540016", "0804006", "0976964", "0755348", "0834887", "0749549", "0469700", "0983851", "1018961", "1021056", "0883738", "1062554", "0648671", "1034847", "0583043", "0922569", "1055736", "1062629", "0674270", "0806304", "1015004", "0800485", "0916711", "0882384", "0473597", "1000730", "0540685", "1033285", "1016722", "1055976", "0945066", "0549624", "1063065", "1040714", "0735175", "0976795", "0396559", "0956219", "0289450", "0772202", "0434670", "0753054", "1048197", "0767515", "1046954", "1057325", "0993210", "0844722", "0975658", "0710479", "1029433", "0973585", "1052449", "1007339", "1014194", "0979047", "1059891", "0815017", "0459704", "0886294", "0622198", "0929996", "1057007", "0595842", "0992132", "0386683", "1051888", "1012999", "0158043", "1045464", "1059198", "0618572", "1011956", "0227123", "0546268", "0959035", "0437691", "0479310", "0609505", "0708487", "0289622", "0701055", "0272047", "0987530", "0693517", "1048614", "0754241", "1008655", "0732081", "1045177", "1009324", "0771419", "0974331", "0591772", "1061725", "1063054", "0584798", "1018279", "0247544", "0548122", "0805078", "0320533", "1061855", "0892899", "1045601", "0783509", "0622207", "1053232", "1007931", "0841519", "1049540", "0977878", "1010261", "0954737", "1003590", "1039413", "0963607", "1017596", "0891007", "0964443", "0928247", "0876555", "0838434", "1016127", "0971358", "0894733", "1062306", "1027421", "0555552", "0633058", "0951299", "1058070", "1035156", "1038951", "0301215", "0930831", "0967067", "0833132", "0639486", "1019817", "0819762", "1054791", "0525764", "0733900", "0334447", "0724037", "0226738", "1063086", "1057615", "1055432", "0840018", "0651041", "0965664", "0180357", "1007184", "0629216", "0181330", "0991500", "0993724", "0325167", "0713599", "0523130", "0853214", "0875053", "0818134", "0993525", "0725798", "0151540", "0888828", "0826392", "1060168", "1045213", "1042025", "0850345", "1023922", "1061220", "0900531", "0835870", "0866951", "0311184", "1028517", "0907660", "0125646", "0562071", "0983504", "1055646", "0521037", "0865150", "0421349", "0959252", "0741112", "0579454", "0833717", "0826543", "0959888", "0986799", "0531128", "0905162", "0856700", "1027064", "1008711", "0526788", "1001495", "0601492", "0920274", "0681685", "0831416", "1061346", "0801181", "1020160", "1030752", "0620897", "0985382", "0912122", "0978940", "0984552", "0966179", "0761334", "0850692", "0974000", "0960370", "1028308", "1053090", "1055711", "0330699", "1048171", "0256518", "0908188", "0738344", "0699365", "0244994", "1055338", "1062279", "0762151", "1057618", "0997838", "1060951", "1000403", "0745023", "0524063", "1061891", "1057140", "0589059", "0969084", "0936701", "0825104", "0930544", "0963977", "1025718", "0474595", "0744008", "1014109", "1062584", "0688395", "1036682", "0508366", "1044082", "0327271", "1043883", "0841402", "0786237", "1021514", "0497891", "1050159", "0934848", "0859431", "0919542", "0475614", "0820971", "0370330", "0647867", "0893567", "1043935", "0240359", "0368475", "0523179", "0692726", "0662194", "1052391", "1046252", "0791260", "0714389", "0332381", "0132164", "0611991", "0954034", "1060902", "1062225", "0985976", "0475702", "1031019", "0304520", "1044919", "0965024", "0140585", "0704303", "0649034", "1025452", "1059736", "1059578", "0588315", "0924242", "0403491", "0224622", "0859886", "0850349", "0533160", "0822302", "1059784", "0940933", "0336387", "0793242", "1062398", "0945522", "0796969", "0792906", "0505694", "0950784", "1040186", "0406865", "1055647", "0989298", "1034066", "0541725", "0330216", "0406865", "1055647", "0989298", "1034066", "0541725", "0330216", "0924350", "0694911", "1052413", "0936757", "1030202", "1047089", "0007832", "0991119", "0962904", "0757927", "0706328", "1026721", "1006082", "1049130", "1053589", "0434228", "1048477", "1060890", "0894452", "0796416", "0337809", "0129498", "0410045", "1020072", "1039429", "0870917", "1021338", "1035393", "1052244", "1048282", "1061821", "0835668", "0758816", "0947061", "1040455", "1056741", "1019925", "0537745", "0983329", "0571639", "0758759", "1007941", "1062772", "0763631", "0850003", "1054683", "1054888", "1027475", "1050211", "1009627", "0394572", "0418851", "0779825", "0730961", "1048605", "0673602", "0314265", "1063020", "1062151", "0435342", "0742925", "1034565", "0833024", "1024363", "0982817", "0838557", "1061227", "1031230", "1059535", "1049692", "0548695", "0944469", "1046147", "0906258", "0857008", "0983833", "1038597", "1061173", "1040175", "0872032", "1058922", "0866933", "1015933", "0669501", "1062321", "1034055", "0954204", "1015930", "0258887", "0971975", "0997060", "1017385", "0693016", "0989737", "0157135", "0590989", "1048147", "1062961", "0669276", "0698902", "0616030", "0995753", "0828572", "1061791", "0960559", "1063070", "1035922", "1031321", "1057178", "0778238", "0482637", "0884741", "0895657", "0690240", "1050856", "1048594", "0879480", "0958562", "1006007", "0717793", "1059621", "0523183", "1013430", "0543553", "0585833", "0197485", "0922168", "1056167", "0377190", "0832003", "0660520", "0309509", "0981325", "0401572", "0733408", "0806690", "1061978", "0924629", "0652608", "0828925", "0803459", "0546547", "0840170", "1055341", "0794871", "0427753", "0891702", "0922585", "1062360", "1063013", "0995189", "1058391", "0883260", "0784257", "0667192", "0873531", "1050268", "0749110", "0705977", "0982519", "0748027", "0996620", "0917836", "0913759", "0809231", "0534990", "0653051", "0934467", "1042341", "0558418", "1034126", "1056371", "1051528", "0532502", "0885899", "0841273", "1052802", "1063052", "1011134", "0541083", "1056150", "0152103", "0385938", "1055992", "0903366", "1058261", "1050022", "0811185", "0816401", "0172156", "0666283", "0980955", "0844499", "0434233", "0896418", "0405922", "1061178", "0562205", "0934565", "0932548", "0986224", "0801117", "0179080", "0786101", "0993425", "0789143", "0621624", "1044228", "0952594", "0748973", "0571158", "0292445", "0637660", "1027665", "1013892", "0984688", "1001512", "0848400", "1046281", "0985339", "0669923", "0905984", "0994997", "1029176", "0300307", "0655918", "0694431", "0761392", "0806067", "0636015", "0992003", "0846651", "0893231", "0835775", "0369561", "0414397", "1017661", "0995594", "0891876", "0540222", "0981793", "0765309", "1047711", "0578192", "1021423", "1027852", "0392916", "0829619", "0973038", "1037346", "1048519", "1033385", "0847259", "0867616", "0995317", "1046039", "1045986", "0896466", "0638742", "0895778", "1061199", "1062282", "0211199", "0953851", "0608463", "1009405", "0894283", "0938215", "0833186", "0791600", "1027222", "0982536", "0394492", "0759863", "0734884", "0993948", "0687824", "1005469", "0840757", "0104437", "0724138", "1022862", "0748342", "0920902", "0977940", "0889169", "1047804", "0098577", "0926985", "1015744", "1058621", "0920721", "0768158", "0674353", "0618189", "1015950", "1024544", "0043964", "0956317", "0840328", "0920576", "0258538", "1002538", "1032455", "1024860", "1051764", "1013262", "0978616", "0512908", "0933413", "0857090", "0690893", "1047849", "0910443", "0986228", "0897900", "0195799", "0618138", "0709182", "0964430", "0865443", "0455289", "0346798", "0531942", "0573006", "0832690", "0440491", "0965147", "0402458", "0434371", "0182459", "0155250", "1013045", "0781753", "0383852", "0968014", "0992946", "0869293", "0767611", "0443383", "0519734", "0776342", "0956736", "0967061", "0993428", "0625524", "0752206", "1021516", "0768908", "0964144", "0987206", "0785920", "0549058", "0341715", "1061276", "0984632", "0860019", "1014603", "1034784", "0856040", "0845498", "1034231", "0893639", "0239792", "0980596", "1041924", "0937613", "0161499", "0302911", "1000425", "1042804", "0951369", "1041107", "1030723", "1028052", "0422294", "1061785", "0989038", "0957866", "0983796", "1004396", "1057373", "0544379", "1048295", "0932882", "0918969", "1059186" };
            var allInmates1 = new List<Inmate>();
            foreach (var inmate in allInmates)
            {
                var cid = inmate.CID;
                var url = $"https://inmatesearch.tarrantcounty.com/Home/Details?CID={cid}";
                await page.GotoAsync(url);

                // Wait for details to load
                await page.WaitForSelectorAsync("form table"); // Wait for the demographics table

                // Scrape demographics
                string lastName = await page.InnerTextAsync("td:has-text('Last Name:') b");
                string firstName = await page.InnerTextAsync("td:has-text('First Middle Name:') b");
                string race = await page.InnerTextAsync("td:has-text('Race:') b");
                string gender = await page.InnerTextAsync("td:has-text('Sex:') b");
                
                string? imageSrc = null;
                try
                {
                    var img = await page.QuerySelectorAsync("td[rowspan] img");
                    if (img != null)
                    {
                        imageSrc = await img.GetAttributeAsync("src");
                        if (!string.IsNullOrEmpty(imageSrc) && imageSrc.StartsWith("data:image"))
                        {
                            var base64Data = Regex.Replace(imageSrc, @"^data:image\/[a-zA-Z]+;base64,", "");
                            var imageBytes = Convert.FromBase64String(base64Data);
                            var imageFile = Path.Combine(Directory.GetCurrentDirectory(), "InmateImages", $"{cid}.jpg");
                            await File.WriteAllBytesAsync(imageFile, imageBytes);
                            Console.WriteLine($"Saved image: {imageFile}");
                        }
                    }
                }
                catch
                {
                    Console.WriteLine($"No image found for CID {cid}");
                }

                allInmates1.Add(new Inmate
                {
                    CID = cid,
                    LastName = lastName,
                    FirstName = firstName,
                    Gender = gender,
                    Race = race,
                    // DOB = dob
                    ImageBase64 = $"{cid}.jpg"
                });

                Console.WriteLine($"Added {firstName} {lastName} ({cid})");
            }

            // Sort by LastName then FirstName
            allInmates1 = allInmates1.OrderBy(x => x.LastName).ThenBy(x => x.FirstName).ToList();








            // Save to Excel
            using var workbook = new XLWorkbook();
            var ws = workbook.Worksheets.Add("Inmates");
            ws.Cell(1, 1).Value = "CID";
            ws.Cell(1, 2).Value = "Last Name";
            ws.Cell(1, 3).Value = "First Name";
            ws.Cell(1, 4).Value = "DOB";
            ws.Cell(1, 5).Value = "Gender";
            ws.Cell(1, 6).Value = "Race";
            ws.Cell(1, 7).Value = "Image";

            for (int i = 0; i < allInmates1.Count; i++)
            {
                var inmate = allInmates1[i];
                ws.Cell(i + 2, 1).Value = inmate.CID;
                ws.Cell(i + 2, 2).Value = inmate.LastName;
                ws.Cell(i + 2, 3).Value = inmate.FirstName;
                ws.Cell(i + 2, 4).Value = inmate.DOB;
                ws.Cell(i + 2, 5).Value = inmate.Gender;
                ws.Cell(i + 2, 6).Value = inmate.Race;
                ws.Cell(i + 2, 7).Value = inmate.ImageBase64;
            }

            workbook.SaveAs("Inmates.xlsx");
            Console.WriteLine("Excel file created: Inmates.xlsx");
            return $"Found inmate (CID ). Flow completed successfully.";
        }
    }
    class Inmate
    {
        public string CID { get; set; } = "";
        public string LastName { get; set; } = "";
        public string FirstName { get; set; } = "";
        public string DOB { get; set; } = "";
        public string Gender { get; set; } = "";
        public string Race { get; set; } = "";
        public string ImageBase64 { get; set; } = "";
    }
}

